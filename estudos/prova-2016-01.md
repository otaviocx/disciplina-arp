# Resolução da Prova de 2016 - 01

#### Questão 02 - Sobre o algoritmo KNN, qual o melhor valor de K? Justifique sua resposta.

###### Resposta

Dada uma nova instância, queremos classificá-la em uma das classes existentes, de acordo com a distância entre ela e as outras instâncias já classificadas. O valor de K é a quantidade de vizinhos próximos (com as menores distâncias) da instancia que está para ser classificada. Logo, K não deve ser múltiplo da quantidade de classes existentes, para evitar que dê empate (cada um dos K vizinhos seja de uma classe). Como já sabemos a classe de uma quantidade de instâncias (base de treinamento), o melhor valor de K será aquele que maximiza a acurácia de classificação para essas instâncias (pode-se pegar uma parte da base que já sabemos a classe para teste de acurácia). Com isso, é importante que a base de treinamento seja variada (tendo uma quantidade próxima de amostras para cada classe) e que a porção tomada para teste também seja.

___

#### Questão 03 - Na análise discriminante quadrática, as distribuições das classes são modeladas como distribuições normais multivariadas. Assume-se que as observações do vetor de atributos pertencentes à j-ésima classe estejam distribuídas de acordo com uma função densidade de probabilidade conjunta expressa pela Equação abaixo. 
**Parte 1) Mostre como obter a função discriminante quadrática e linear a partir da equação apresentada.** 

###### Resposta

**Parte 2) Discuta qual é a diferença fundamental no equacionamento das duas abordagens (quadrática e linear) e como as fronteiras geradas por ambas pode afetar a capacidade de generalização de novos objetos a serem classificados, particularmente, em objetos que porventura possam estar contaminados com ruídos de medidas instrumentais.**

###### Resposta

___

#### Questão 05 - Uma agência de seguro de automóveis deseja otimizar o atendimento de seus clientes encaminhando-os a departamentos específicos. Caso o motivo da visita a agência seja sinistro o cliente é encaminhado ao gichê 1 e caso seja roubo o cliente é encaminhado ao gichê 2. O administrador da agência identificou 3 informações que são relevantes ao para a tomada de decisão: Cor do carro (C), tipo do carro (T) e origem (O). A Tabela 1 apresenta o conhecimento prévio sobre os atendimentos da agência. Usando um classificador Bayesiano simples, a qual gichê o cliente que possui um SUV importado vermelho deve ser encaminhado?


Amostra|	Cor|	Tipo|	Origem|	Gichê
--- | --- | --- | --- | ---
1|	Vermelho|	SUV|	Nacional|	2
2|	Amarelo|	Esportivo|	Importado|	1
3|	Vermelho|	Esportivo|	Nacional|	2
4|	Amarelo|	Esportivo|	Nacional|	1
5|	Amarelo|	Esportivo|	Importado|	2
6|	Amarelo|	SUV|	Importado|	1
7|	Amarelo|	SUV|	Importado|	2
8|	Amarelo|	SUV|	Nacional|	1
9|	Vermelho|	SUV|	Importado|	1
10|	Vermelho|	Esportivo|	Importado|	2
**Tabela 1.** Dados da agência de seguros.

###### Resposta

**Teorema de Bayes:** 
$$ P(C_k|x) = [ P(C_k)P(x|C_k) ] / P(x) $$

onde:
* $x$ é um vetor de entradas
* $P(C_k|x)$ é a probabilidade de $C_k$ dado $x$
* $P(C_k)$ é a probabilidade geral de $C_k$
* $P(x|C_k)$ é a probabilidade de $x$ dado $C_k$

**Classificador Naive Bayes:**
$$ y' = argmax(p(C_k)\coprod_{i=1}^n p(x_i|C_k)) $$

onde:

* $y'$ é a classe estimada para a entrada informada
* $\coprod_{i=1}^n p(x_i|C_k)$ é o produtório das probabilidades de cada característica de entrada $x_i$ dado a classe $C_k$
* $i$ itera sobre as caracteristicas da entrada (vetor de entrada) e $k$ itera sobre as classes possíveis.
* $argmax$ retorna o índice em que o maior valor está (argumento/índice do maior valor).


No problema proposto temos 3 características que compõem o vetor de entradas $x$ : Cor, Tipo e Origem. 

* $x_1$ => Cor
* $x_2$ => Tipo
* $x_3$ => Origem

Logo, o carro que queremos classificar pode ser representado pelo vetor $x = [vermelho, SUV, importado]$.

O que desejamos saber ( $y$ ) é o Gichê, que possui 2 valores possíveis: $1$ ou $2$. Na amostra temos 10 carros, sendo 5 em cada uma das duas classes. Ou seja, exatamente a metade. Logo, a probabilidade de ser um dos dois Guichês ($p(C_k)$) é de $1/2$.

* $p(C_k) = 1/2$ para $k = 1$ ou $k = 2$

A parte do produtório teremos que resolver para cada classe. Iniciaremos com a classe 1 (Guichê 1): $p(x_1=vermelho|C_1) * p(x_2=SUV|C_1) * p(x_3=importado|C_1)$

* $p(x_1=vermelho|C_1) = 1/5$ => 1 dos 5 carros em $C_1$ é vermelho.
* $p(x_2=SUV|C_1) = 3/5$ => 3 dos 5 carros em $C_1$ são SUVs.
* $p(x_3=importado|C_1) = 3/5$ => 3 dos 5 carros em $C_1$ são importados.

temos: 
$$p(C_1) = 1/2$$
$$\coprod_{i=1}^n p(x_i|C_1) = 1/5 * 3/5 * 3/5 = 9/125$$

logo:
$$p(C_1)\coprod_{i=1}^n p(x_i|C_1) = 1/2 * 9/125 = 9/250$$

Para a classe 2 (Guichê 2): $p(x_1=vermelho|C_2) * p(x_2=SUV|C_2) * p(x_3=importado|C_2)$

* $p(x_1=vermelho|C_2) = 3/5$ => 3 dos 5 carros em $C_2$ são vermelhos.
* $p(x_2=SUV|C_2) = 2/5$ => 2 dos 5 carros em $C_2$ são SUVs.
* $p(x_3=importado|C_2) = 3/5$ => 3 dos 5 carros em $C_2$ são importados.

temos: 
$$p(C_2) = 1/2$$
$$\coprod_{i=1}^n p(x_i|C_2) = 3/5 * 2/5 * 3/5 = 18/125$$

logo:
$$p(C_2)\coprod_{i=1}^n p(x_i|C_2) = 1/2 * 18/125 = 18/250$$

Aplicando o $argmax$ no vetor resultante $[9/250, 18/250]$ temos que a probabilidade maior é para classe 2. Com isso, o SUV vermelho importado seria classificado para ir ao Guichê 2.
